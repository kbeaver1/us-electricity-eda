---
title: "EDA for Electricity Dataset"
author: "Kendall Beaver"
date: "2024-06-19"
output: html_document
---

# Electricity Wholesale Analysis (2014-2024)

Resource: <https://www.eia.gov/electricity/wholesale/>

## Load Library

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(dplyr)
```

## 2014-2024 Datasets

Import all datasets into their own variables.

```{r 2014-2015}

data_2014 <- read_excel ("./Data/ice_electric-2014final.xls")
# Need to correct "Nepool MH Da LMP Peak" to "Nepool MH DA LMP Peak"
# Need to correct "NP 15 EZ..." to "NP15 EZ Gen..."
# Correct "Palo Verde" to "Palo Verde Peak"
# Change "SP-15 Gen DA LMP Peak" to "SP15 EZ Gen DA LMP Peak"

data_2014 <- data_2014 %>%
  mutate(`Price hub` = 
           ifelse(`Price hub` == "Nepool MH Da LMP Peak", "Nepool MH DA LMP Peak",
           ifelse(`Price hub` == "Indiana Hub RT Peak", "Indiana Rt Peak",
           ifelse(`Price hub` == "PJM-Wh Real Time Peak", "PJM Wh Real Time Peak",
           ifelse(`Price hub` == "Mid Columbia Peak", "Mid C Peak",
           ifelse(`Price hub` == "PJM Wh Real Time Peak", "PJM WH Real Time Peak",
           ifelse(`Price hub` == "NP 15 EZ Gen DA LMP Peak", "NP15 EZ Gen DA LMP Peak",
           ifelse(`Price hub` == "Palo Verde", "Palo Verde Peak",
           ifelse(`Price hub` == "SP15 EZ Gen DA LMP Peak", "SP-15 Gen DA LMP Peak", `Price hub`)))))))))
data_2014

data_2015 <- read_excel ("./Data/ice_electric-2015final.xls")
data_2015

data_2016 <- read_excel ("./Data/ice_electric-2016final.xls")
data_2016

data_2017 <- read_excel ("./Data/ice_electric-2017final.xlsx")
data_2017

data_2018 <- read_excel ("./Data/ice_electric-2018final.xlsx")
data_2018

data_2019 <- read_excel ("./Data/ice_electric-2019final.xlsx")
data_2019

data_2020 <- read_excel ("./Data/ice_electric-2020final.xlsx")
data_2020

data_2021 <- read_excel ("./Data/ice_electric-2021final.xlsx")
data_2021

data_2022 <- read_excel ("./Data/ice_electric-2022final.xlsx")
data_2022 <- select(data_2022, -'Trade date') # REMOVE COLUMN because it's bad
data_2022$'Trade date' <- data_2022$`Delivery start date` - 86400
data_2022 <- data_2022 %>% select(1, `Trade date`, everything()) # Make 'Trade date' the 2nd column like all the other datasets
data_2022

data_2023 <- read_excel ("./Data/ice_electric-2023final.xlsx")
data_2023

data_2024 <- read_excel ("./Data/ice_electric-2024.xlsx")
data_2024
```

## Head 2014-2024

Use the following to make mass changes:

1.  One quick suggestion on how to more effectively use grepl is that you can separate things out with \|. So for example, ifelse(grepl("tequi\|agave", Alcohol_Type1, ignore.case = TRUE), "TEQUILA", That should help shorten up some of your code. Similarly, use the %in% function for longer lists, e.g. ifelse(Item.Description %in% c("MAKER'S MARK CO-PACK", "HA ORPHAN BARREL BARTERHOUSE"), "BOURBON",

```{r head}

# 8 Peaks (2014-2019):
#
# "ERCOT North 345KV Peak"  
# "Indiana Rt Peak"         
# "Mid C Peak"              
# "Nepool MH DA LMP Peak"   
# "NP15 EZ Gen DA LMP Peak"
# "Palo Verde Peak"         
# "PJM WH Real Time Peak"
# "SP-15 Gen DA LMP Peak"

unique(data_2014$`Price hub`)
unique(data_2015$`Price hub`) 
unique(data_2016$`Price hub`)
unique(data_2017$`Price hub`)
unique(data_2018$`Price hub`)
unique(data_2019$`Price hub`)

# 7 Peaks (2020-2024):

# Indiana Hub RT Peak
# Mid C Peak
# Nepool MH DA LMP Peak
# NP15 EZ Gen DA LMP Peak
# Palo Verde Peak
# PJM WH Real Time Peak
# SP15 EZ Gen DA LMP Peak
# 
# Missing is "ERCOT North 345KV Peak"

unique(data_2020$`Price hub`) # 7 Peaks
unique(data_2021$`Price hub`) # 7 Peaks
unique(data_2022$`Price hub`) # 7 Peaks
unique(data_2023$`Price hub`) # 7 Peaks
unique(data_2024$`Price hub`) # 7 Peaks
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
